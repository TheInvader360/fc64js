!function(e){"use strict";let s,t;function r(){t.frequency.value=0}function n(){s.resume()}const i=1,d=2,o=4,u=64,a=64,c=[{id:"U",index:12,physicalButtonPressed:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"D",index:13,physicalButtonPressed:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"L",index:14,physicalButtonPressed:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"R",index:15,physicalButtonPressed:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"A",index:0,physicalButtonPressed:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"B",index:1,physicalButtonPressed:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1}];const l=()=>{for(const e of c)e.physicalButtonPressed=!1},A=(e,s)=>s>e.buttons.length-1?null:e.buttons[s],p=[{id:"U",x:13,y:78,width:9,height:9,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"D",x:13,y:98,width:9,height:9,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"L",x:3,y:88,width:9,height:9,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"R",x:23,y:88,width:9,height:9,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"A",x:42,y:88,width:12,height:12,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"B",x:57,y:79,width:12,height:12,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1}];let f,h,g;const P=new Map;const w=(e,s)=>!![...e.values()].includes(s),m=e=>B(e.pageX,e.pageY,-1),v=e=>E(e.pageX,e.pageY,-1),y=e=>D(e.pageX,e.pageY,-1),C=e=>{for(const s of e.changedTouches)B(s.pageX,s.pageY,s.identifier)},R=e=>{e.preventDefault();for(const s of e.changedTouches)E(s.pageX,s.pageY,s.identifier)},J=e=>{e.preventDefault();for(const s of e.changedTouches)D(s.pageX,s.pageY,s.identifier)},B=(e,s,t)=>{const r=b(e,s),n=L(r.x,r.y);null==n?P.set(`${t}`,"-"):P.set(`${t}`,n.id)},E=(e,s,t)=>{if(P.get(`${t}`)){const r=b(e,s),n=L(r.x,r.y);null==n?P.set(`${t}`,"-"):P.set(`${t}`,n.id)}},D=(e,s,t)=>P.delete(`${t}`),b=(e,s)=>{if(null!=screen)return{x:Math.round(((e-f.offsetLeft)/f.clientWidth+.5)*h),y:Math.round(((s-f.offsetTop)/f.clientHeight+.5)*g)}},L=(e,s)=>{for(let t=0;t<p.length;t++){const r=p[t];if(e>=r.x&&e<=r.x+r.width&&s>=r.y&&s<=r.y+r.height)return r}return null},x=[{id:"U",codes:["ArrowUp","KeyW"],physicalKeyDown:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"D",codes:["ArrowDown","KeyS"],physicalKeyDown:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"L",codes:["ArrowLeft","KeyA"],physicalKeyDown:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"R",codes:["ArrowRight","KeyD"],physicalKeyDown:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"A",codes:["KeyZ","Period"],physicalKeyDown:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1},{id:"B",codes:["KeyX","Slash"],physicalKeyDown:!1,pressedPrevious:!1,pressedCurrent:!1,isPressed:!1,isJustPressed:!1,isJustReleased:!1}];const M=e=>{"F1"!==e.code&&"F3"!==e.code&&"F6"!==e.code&&"F7"!==e.code&&"Tab"!==e.code&&"AltLeft"!==e.code&&"AltRight"!==e.code&&"ArrowRight"!==e.code&&"ArrowDown"!==e.code&&"ArrowLeft"!==e.code&&"ArrowUp"!==e.code||e.preventDefault();const s=S(e.code);null!=s&&(s.physicalKeyDown=!0)},U=e=>{const s=S(e.code);null!=s&&(s.physicalKeyDown=!1)},S=e=>{for(let s=0;s<x.length;s++){const t=x[s];if(t.codes.includes(e))return t}return null},K=0,T=4096,I=4102,O=4104,Y=4104,F=[];function k(e){if(e<0||e>Y)throw`Invalid address: peek ${e}`;return F[e]}function N(e,s){if(e<0||e>Y)throw`Invalid address: poke ${e}`;F[e]=s}const _={charWidth:3,charHeight:5,charTrackingDefault:1,charMap:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,1,0,0,1,0,0,0,0,0,1,0],[1,0,1,1,0,1,0,0,0,0,0,0,0,0,0],[1,0,1,1,1,1,1,0,1,1,1,1,1,0,1],[0,1,0,1,1,1,1,0,0,1,1,1,0,1,0],[1,0,1,0,0,1,0,1,0,1,0,0,1,0,1],[1,1,0,1,1,0,1,1,1,1,0,1,0,1,1],[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,1,0,0,1,0,0,1,0,0,0,1],[1,0,0,0,1,0,0,1,0,0,1,0,1,0,0],[0,0,0,1,0,1,0,1,0,1,0,1,0,0,0],[0,0,0,0,1,0,1,1,1,0,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,1,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,1,0,0,1,0,1,0,1,0,0,1,0,0],[1,1,1,1,0,1,1,0,1,1,0,1,1,1,1],[0,1,0,1,1,0,0,1,0,0,1,0,1,1,1],[1,1,1,0,0,1,1,1,1,1,0,0,1,1,1],[1,1,1,0,0,1,0,1,1,0,0,1,1,1,1],[1,0,1,1,0,1,1,1,1,0,0,1,0,0,1],[1,1,1,1,0,0,1,1,1,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1,0,1,1,1,1],[1,1,1,0,0,1,0,0,1,0,0,1,0,0,1],[1,1,1,1,0,1,1,1,1,1,0,1,1,1,1],[1,1,1,1,0,1,1,1,1,0,0,1,1,1,1],[0,0,0,0,1,0,0,0,0,0,1,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,1,0,1,0,0],[0,0,1,0,1,0,1,0,0,0,1,0,0,0,1],[0,0,0,1,1,1,0,0,0,1,1,1,0,0,0],[1,0,0,0,1,0,0,0,1,0,1,0,1,0,0],[1,1,1,0,0,1,0,1,0,0,0,0,0,1,0],[1,1,1,1,0,1,1,0,1,1,0,0,1,1,1],[1,1,1,1,0,1,1,1,1,1,0,1,1,0,1],[1,1,1,1,0,1,1,1,0,1,0,1,1,1,1],[1,1,1,1,0,0,1,0,0,1,0,0,1,1,1],[1,1,0,1,0,1,1,0,1,1,0,1,1,1,0],[1,1,1,1,0,0,1,1,0,1,0,0,1,1,1],[1,1,1,1,0,0,1,1,0,1,0,0,1,0,0],[1,1,1,1,0,0,1,0,1,1,0,1,1,1,1],[1,0,1,1,0,1,1,1,1,1,0,1,1,0,1],[1,1,1,0,1,0,0,1,0,0,1,0,1,1,1],[0,0,1,0,0,1,0,0,1,1,0,1,1,1,1],[1,0,1,1,0,1,1,1,0,1,0,1,1,0,1],[1,0,0,1,0,0,1,0,0,1,0,0,1,1,1],[1,0,1,1,1,1,1,0,1,1,0,1,1,0,1],[1,0,1,1,1,1,1,1,1,1,0,1,1,0,1],[1,1,1,1,0,1,1,0,1,1,0,1,1,1,1],[1,1,1,1,0,1,1,1,1,1,0,0,1,0,0],[1,1,1,1,0,1,1,0,1,1,1,1,0,0,1],[1,1,1,1,0,1,1,1,0,1,0,1,1,0,1],[1,1,1,1,0,0,1,1,1,0,0,1,1,1,1],[1,1,1,0,1,0,0,1,0,0,1,0,0,1,0],[1,0,1,1,0,1,1,0,1,1,0,1,1,1,1],[1,0,1,1,0,1,1,0,1,1,0,1,0,1,0],[1,0,1,1,0,1,1,0,1,1,1,1,1,0,1],[1,0,1,1,0,1,0,1,0,1,0,1,1,0,1],[1,0,1,1,0,1,0,1,0,0,1,0,0,1,0],[1,1,1,0,0,1,0,1,0,1,0,0,1,1,1],[0,1,1,0,1,0,0,1,0,0,1,0,0,1,1],[1,0,0,1,0,0,0,1,0,0,0,1,0,0,1],[1,1,0,0,1,0,0,1,0,0,1,0,1,1,0],[0,1,0,1,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],[0,0,0,1,0,0,1,1,1,1,0,1,1,1,1],[0,0,0,0,0,0,1,1,1,1,0,0,1,1,1],[0,0,0,0,0,1,1,1,1,1,0,1,1,1,1],[0,0,0,0,0,0,1,1,0,1,1,0,1,1,1],[0,0,0,0,1,1,0,1,0,1,1,1,0,1,0],[0,0,0,1,1,1,1,1,1,0,0,1,1,1,1],[0,0,0,1,0,0,1,1,1,1,0,1,1,0,1],[0,0,0,0,1,0,0,0,0,0,1,0,0,1,0],[0,0,0,0,1,0,0,0,0,0,1,0,1,1,0],[0,0,0,1,0,0,1,0,1,1,1,0,1,0,1],[0,0,0,0,1,0,0,1,0,0,1,0,0,1,1],[0,0,0,0,0,0,1,1,1,1,1,1,1,0,1],[0,0,0,0,0,0,1,1,1,1,0,1,1,0,1],[0,0,0,0,0,0,1,1,1,1,0,1,1,1,1],[0,0,0,1,1,1,1,0,1,1,1,1,1,0,0],[0,0,0,1,1,1,1,0,1,1,1,1,0,0,1],[0,0,0,0,0,0,1,1,1,1,0,0,1,0,0],[0,0,0,0,0,0,0,1,1,0,1,0,1,1,0],[0,0,0,0,1,0,1,1,1,0,1,0,0,1,1],[0,0,0,0,0,0,1,0,1,1,0,1,1,1,1],[0,0,0,0,0,0,1,0,1,1,0,1,0,1,0],[0,0,0,0,0,0,1,0,1,1,1,1,1,1,1],[0,0,0,0,0,0,1,0,1,0,1,0,1,0,1],[0,0,0,1,0,1,1,1,1,0,0,1,1,1,0],[0,0,0,1,1,1,0,1,0,0,0,1,1,1,0],[0,1,1,0,1,0,1,0,0,0,1,0,0,1,1],[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],[1,1,0,0,1,0,0,0,1,0,1,0,1,1,0],[0,0,0,0,0,0,0,1,1,1,1,0,0,0,0]]};function X(e,s,t,r){if(e>s){const t=e;e=s,s=t}for(let n=e;n<=s;n++)W(n,t,r)}function W(e,s,t){e<0||e>=u||s<0||s>=a||N(K+(0|e)+(0|s)*u,t)}function G(e,s,t,r,n){const i=s.charMap[e.charCodeAt(0)-32];for(let e=0;e<s.charWidth;e++)for(let d=0;d<s.charHeight;d++)1===i[e+d*s.charWidth]&&W(t+e,r+d,n)}let V,Q,j,$,z=performance.now();const H=72,q=128,Z=4,ee=4;function se(e){e-z>1e3/61&&(N(O,Math.round(1e3/(e-z))),z=e,function(){for(const e of x)e.pressedPrevious=e.pressedCurrent,e.pressedCurrent=e.physicalKeyDown,e.isPressed=e.pressedCurrent,e.isJustPressed=e.pressedCurrent&&!e.pressedPrevious,e.isJustReleased=!e.pressedCurrent&&e.pressedPrevious}(),function(){const e=navigator.getGamepads()[0];if(e)for(const s of c){const t=A(e,s.index);null!=t&&(t.pressed?s.physicalButtonPressed=!0:s.physicalButtonPressed=!1)}for(const e of c)e.pressedPrevious=e.pressedCurrent,e.pressedCurrent=e.physicalButtonPressed,e.isPressed=e.pressedCurrent,e.isJustPressed=e.pressedCurrent&&!e.pressedPrevious,e.isJustReleased=!e.pressedCurrent&&e.pressedPrevious}(),function(){for(const e of p)e.pressedPrevious=e.pressedCurrent,e.pressedCurrent=w(P,e.id),e.isPressed=e.pressedCurrent,e.isJustPressed=e.pressedCurrent&&!e.pressedPrevious,e.isJustReleased=!e.pressedCurrent&&e.pressedPrevious}(),function(){for(let e=0;e<6;e++){let s=0;(x[e].isPressed||c[e].isPressed||p[e].isPressed)&&(s|=i),(x[e].isJustPressed||c[e].isJustPressed||p[e].isJustPressed)&&(s|=d),(x[e].isJustReleased||c[e].isJustReleased||p[e].isJustReleased)&&(s|=o),N(T+e,s)}}(),function(){const e=k(I),s=k(I+1);e>0&&s>0?function(e){t.frequency.value=e}(e):r(),s>0&&N(I+1,s-1)}(),romLoop(),function(){for(let e=K;e<K+u*a;e++){const s=j[k(e)];$.data[4*e+0]=s.r,$.data[4*e+1]=s.g,$.data[4*e+2]=s.b,$.data[4*e+3]=255}Q.putImageData($,Z,ee)}()),window.requestAnimationFrame(se)}window.addEventListener("load",(function(){(function(){for(let e=0;e<=Y;e++)F.push(0)})(),s=new window.AudioContext,t=s.createOscillator(),t.type="square",t.frequency.value=0,t.connect(s.destination),t.start(0),window.addEventListener("mousedown",n),window.addEventListener("touchstart",n),window.addEventListener("keydown",n),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&r()})),document.addEventListener("keydown",M),document.addEventListener("keyup",U),function(){const e=[0,255,16711680,16711935,65280,65535,16776960,16777215];j=[];for(let s=0;s<=7;s++){const t=e[s],r=(16711680&t)>>16,n=(65280&t)>>8,i=255&t;j.push({r:r,g:n,b:i})}}(),function(){const e="-webkit-touch-callout: none; -webkit-tap-highlight-color: #000; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; background: #000; color: #888;",s="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); background: #000};",t="image-rendering: -moz-crisp-edges; image-rendering: -webkit-optimize-contrast; image-rendering: -o-crisp-edges; image-rendering: pixelated;";document.body.style.cssText=e,V=document.createElement("canvas"),V.width=H,V.height=q,Q=V.getContext("2d",{alpha:!1}),Q.imageSmoothingEnabled=!1,V.style.cssText=s+t,Q.fillStyle="#ddd",Q.fillRect(0,0,H,q),Q.fillStyle="#333",Q.fillRect(Z-1,ee-1,u+2,a+2);const r=()=>{const e=innerWidth/innerHeight,s=H/q,t=e<s,r=t?innerWidth:innerHeight*s,n=t?innerWidth/s:innerHeight;V.style.width=`${r}px`,V.style.height=`${n}px`};window.addEventListener("resize",r),r(),document.body.appendChild(V),$=Q.createImageData(u,a)}(),window.addEventListener("gamepaddisconnected",l),function(e,s,t){f=e,h=s,g=t;const r=f.getContext("2d");r.fillRect(13,78,9,29),r.fillRect(3,88,29,9);const n=new Image;n.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAFAQMAAACU+uVzAAAABlBMVEUAAAAzM2bT8ENbAAAAAXRSTlMAQObYZgAAABtJREFUCNdjePdKj6GjS4PhxDsgvWgRQ9+jdwBZWAlP4hlWSwAAAABJRU5ErkJggg==",n.onload=()=>{r.drawImage(n,6,71)};const i=new Image;i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAABlBMVEUAAACZADPodVumAAAAAXRSTlMAQObYZgAAABxJREFUCNdj4GdgsD/AUP8AhP5/gCOICFAKqAAAEwUPVSVDKX4AAAAASUVORK5CYII=",i.onload=()=>{r.drawImage(i,42,88),r.drawImage(i,57,79)};const d=new Image;d.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAFAQMAAABYY9+YAAAABlBMVEUAAAAzM2bT8ENbAAAAAXRSTlMAQObYZgAAABFJREFUCNdjSGCYwPABiCcAAA5KAwFW2JXuAAAAAElFTkSuQmCC",d.onload=()=>{r.drawImage(d,46,101)};const o=new Image;o.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAFAQMAAABYY9+YAAAABlBMVEUAAAAzM2bT8ENbAAAAAXRSTlMAQObYZgAAAA1JREFUCNdjeMAwAYIBEsoDwUh7niQAAAAASUVORK5CYII=",o.onload=()=>{r.drawImage(o,61,92)},document.addEventListener("mousedown",m),document.addEventListener("mousemove",v),document.addEventListener("mouseup",y),document.addEventListener("touchstart",C),document.addEventListener("touchmove",R,{passive:!1}),document.addEventListener("touchend",J,{passive:!1})}(V,H,q),romInit(),window.requestAnimationFrame(se)})),e.ADDRESS_AUD=I,e.ADDRESS_BTN=T,e.ADDRESS_FPS=O,e.ADDRESS_GFX=K,e.BTN_A=4,e.BTN_B=5,e.BTN_D=1,e.BTN_L=2,e.BTN_R=3,e.BTN_U=0,e.COL_BLK=0,e.COL_BLU=1,e.COL_CYN=5,e.COL_GRN=4,e.COL_MAG=3,e.COL_RED=2,e.COL_WHT=7,e.COL_YEL=6,e.GFX_H=a,e.GFX_W=u,e.beep=function(e,s,t){(k(I+1)<=0||t)&&(N(I,Math.floor(e)),N(I+1,Math.floor(s)))},e.clamp=function(e,s,t){return Math.max(s,Math.min(e,t))},e.clearGfx=function(e){for(let s=K;s<K+u*a;s++)N(s,e>0?e:0)},e.drawCircle=function(e,s,t,r,n){n>=0&&function(e,s,t,r){let n=0,i=t,d=1-t;for(;n<=i;)X(e-n,e+n,s-i,r),X(e-i,e+i,s-n,r),X(e-i,e+i,s+n,r),X(e-n,e+n,s+i,r),d<0?d+=2*n+1:(d+=2*(n-i)+1,i--),n++}(e,s,t,n),function(e,s,t,r){let n=0,i=t,d=1-t;for(;n<=i;)W(e+n,s+i,r),W(e+n,s-i,r),W(e-n,s+i,r),W(e-n,s-i,r),W(e+i,s+n,r),W(e+i,s-n,r),W(e-i,s+n,r),W(e-i,s-n,r),d<0?d+=2*n+1:(d+=2*(n-i)+1,i--),n++}(e,s,t,r)},e.drawImage=function(e,s,t,r,n,i){const d=[...n];if(i){const e=[];for(;d.length;)e.push(d.splice(0,t));if(i.flipX)for(let s=0;s<r;s++)e[s].reverse();i.flipY&&e.reverse();for(let s=0;s<r;s++)for(let r=0;r<t;r++)d[s*t+r]=e[s][r]}for(let n=0;n<r;n++)for(let r=0;r<t;r++){const i=d[r+n*t];i>=0&&W(e+r,s+n,i)}},e.drawLine=function(e,s,t,r,n){e===t?function(e,s,t,r){if(s>t){const e=s;s=t,t=e}for(let n=s;n<=t;n++)W(e,n,r)}(e,s,r,n):s===r?X(e,t,s,n):function(e,s,t,r,n){const i=Math.abs(t-e),d=Math.abs(r-s),o=e<t?1:-1,u=s<r?1:-1;let a=i-d;W(e,s,n),W(t,r,n);for(;e!==t&&s!==r;){const t=a<<1;t>-d&&(a-=d,e+=o),t<i&&(a+=i,s+=u),W(e,s,n)}}(e,s,t,r,n)},e.drawPattern=function(e,s,t,r){for(let n=0;n<e.length;n+=2){W(s+e[n],t+e[n+1],r)}},e.drawPixel=W,e.drawRectangle=function(e,s,t,r,n,i){let d=0,o=0,u=0,a=0;t<0?(d=e+t+1,u=e):(d=e,u=e+t-1),r<0?(o=s+r+1,a=s):(o=s,a=s+r-1);for(let e=d;e<=u;e++)for(let s=o;s<=a;s++)e==d||e==u||s==o||s==a?W(e,s,n):i>=0&&W(e,s,i)},e.drawText=function(e,s,t,r,n){const i=(null==n?void 0:n.font)?n.font:_,d=(null==n?void 0:n.tracking)>=0?n.tracking:i.charTrackingDefault;let o=s;for(let s=0;s<e.length;s++)G(e.charAt(s),i,o,t,r),o+=i.charWidth+d},e.getFps=function(){return k(O)},e.getPixel=function(e,s){return e<0||e>=u||s<0||s>=a?-1:k(K+(0|e)+(0|s)*u)},e.isEmptyObject=function(e){return 0===Object.keys(e).length&&e.constructor===Object},e.isJustPressed=function(e){return Boolean(k(T+e)&d)},e.isJustReleased=function(e){return Boolean(k(T+e)&o)},e.isPressed=function(e){return Boolean(k(T+e)&i)},e.peek=k,e.poke=N,e.randomInt=function(e,s){return Math.floor(Math.random()*(s-e+1)+e)},e.swapImageColors=function(e,s,t){if(s.length!=t.length)throw new Error("mismatched old/new list lengths");const r=[...e];for(let n=0;n<s.length;n++)for(let i=0;i<e.length;i++)e[i]===s[n]&&(r[i]=t[n]);return r},e.wrap=function(e,s,t){const r=t-s;return s+((e-s)%r+r)%r}}(window||{});
